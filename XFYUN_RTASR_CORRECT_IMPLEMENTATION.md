# 科大讯飞实时语音转写正确实现

## 问题分析

根据查询到的官方API文档，我发现了问题的根本原因：

### 1. 科大讯飞RTASR的正确接口
- **正确地址**: `ws://rtasr.xfyun.cn/v1/ws`
- **正确参数**: 需要appId和apiKey进行签名认证
- **数据格式**: 直接发送二进制PCM数据，而不是JSON格式

### 2. 我们当前实现的问题
- ❌ 使用了我们自己的代理服务器
- ❌ 发送JSON格式的消息
- ❌ 没有正确的科大讯飞认证

### 3. 正确的实现方式

科大讯飞实时语音转写需要：

1. **认证URL格式**:
```
ws://rtasr.xfyun.cn/v1/ws?appid={APPID}&ts={TIMESTAMP}&signa={SIGNATURE}
```

2. **数据发送格式**:
- 直接发送binary PCM数据
- 每40ms发送40ms的音频数据
- 不需要JSON包装

3. **返回格式**:
```json
{
    "action": "result",
    "code": "0",
    "data": "实时转录文本",
    "desc": "success",
    "sid": "xxx"
}
```

## 需要修复的地方

1. **删除代理服务器** - 直接连接科大讯飞
2. **修复认证** - 使用正确的签名算法
3. **修复数据格式** - 发送binary而不是JSON
4. **修复消息处理** - 处理科大讯飞的实际返回格式

## 建议

由于当前实现与科大讯飞的实际API差异很大，建议：
1. 暂时移除科大讯飞功能
2. 专注于Assembly AI的实现
3. 如需科大讯飞，需要完全重新实现